{"version":3,"sources":["ballot-demo-data.js","instant-runoff.js","candidate.js","ballot-grid.js","result-message.js","leader-board.js","App.js","index.js"],"names":["simpleRandom","split","slice","choiceCount","ballotCount","candidates","idLength","toString","length","Array","fill","map","_","i","votes","reduce","state","Math","floor","random","availableCandidates","splice","selectedCandidate","push","id","padStart","calculateLeaders","counted","leaders","c","l","Object","entries","candidate","voteCount","votePercentage","sort","a","b","performInstantRunoff","ballots","maxRunOffs","runOff","step","losers","nextBallots","ballot","nextVotes","indexOf","shift","filter","removeLoser","runOffs","lastRound","Candidate","className","style","display","width","BallotGrid","onRemove","title","onClick","ResultMessage","results","finalResult","finalLeader","decided","runoff_intro","toFixed","LeaderBoard","App","React","useState","fromEntries","candidatesAvailable","setCandidatesAvailable","setChoiceCount","removeBallotById","idToRemove","arr","ix","index","findIndex","setBallots","setUndos","undos","undo","undofn","pop","tabId","setTabId","useEffect","href","target","rel","role","type","min","max","value","onChange","e","parseInt","checked","BallotDemoData","class","r","disabled","rootElement","document","getElementById","ReactDOM","render"],"mappings":"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","file":"static/js/main.6524f729.chunk.js","sourcesContent":["var candidates = \"🐸,🐰,🐙,🐵,🐼,🦊,🐴,\".split(\",\").slice(0, 6);\r\n//🐮,🐶,,🐭\r\nvar simpleRandom = (choiceCount, ballotCount, candidates) => {\r\n\tconst idLength = ballotCount.toString().length;\r\n\treturn Array(ballotCount)\r\n\t\t.fill()\r\n\t\t.map(\r\n\t\t\t(_, i) => {\r\n\t\t\t\tvar votes = Array(choiceCount)\r\n\t\t\t\t\t.fill()\r\n\t\t\t\t\t.reduce(\r\n\t\t\t\t\t\t(state) => {\r\n\t\t\t\t\t\t\tlet i = Math.floor(\r\n\t\t\t\t\t\t\t\tMath.random() * state.availableCandidates.length\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tlet [selectedCandidate] = \r\n\t\t\t\t\t\t\t\tMath.random() < 0.0\r\n\t\t\t\t\t\t\t\t? ['']\r\n\t\t\t\t\t\t\t\t//a voter may not vote for any one candidate more than once.\r\n\t\t\t\t\t\t\t\t: state.availableCandidates.splice(i, 1);\r\n\t\t\t\t\t\t\tstate.votes.push(selectedCandidate);\r\n\t\t\t\t\t\t\treturn state;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvotes: [],\r\n\t\t\t\t\t\t\tavailableCandidates: candidates.slice(0)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t).votes;\r\n\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tid: (i+1).toString().padStart(idLength,\"0\"),\r\n\t\t\t\t\t\tvotes\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n}\r\nvar emojiAnimals = (choiceCount, ballotCount) => simpleRandom(choiceCount, ballotCount, candidates);\r\n\r\nexport default {\r\n\temojiAnimals,\r\n\tsimpleRandom\r\n};\r\n\r\n/*\r\n\r\n🐻🐱🐯🐷\r\n🙈 See-No-Evil Monkey\r\n🙉 Hear-No-Evil Monkey\r\n🙊 Speak-No-Evil Monkey\r\n🐒 Monkey\r\n🦍 Gorilla\r\n🦧 Orangutan\r\n🐶 Dog Face\r\n🐕 Dog\r\n🦮 Guide Dog\r\n🐕‍🦺 Service Dog\r\n🐩 Poodle\r\n🐺 Wolf\r\n🦊 Fox\r\n🦝 Raccoon\r\n🐱 Cat Face\r\n🐈 Cat\r\n🐈‍⬛ Black Cat\r\n🦁 Lion\r\n🐯 Tiger Face\r\n🐅 Tiger\r\n🐆 Leopard\r\n🐴 Horse Face\r\n🐎 Horse\r\n🦄 Unicorn\r\n🦓 Zebra\r\n🦌 Deer\r\n🦬 Bison\r\n Cow Face\r\n🐂 Ox\r\n🐃 Water Buffalo\r\n🐄 Cow\r\n🐖 Pig\r\n🐗 Boar\r\n🐽 Pig Nose\r\n🐏 Ram\r\n🐑 Ewe\r\n🐐 Goat\r\n🐪 Camel\r\n🐫 Two-Hump Camel\r\n🦙 Llama\r\n🦒 Giraffe\r\n🐘 Elephant\r\n🦣 Mammoth\r\n🦏 Rhinoceros\r\n🦛 Hippopotamus\r\n🐭 Mouse Face\r\n🐁 Mouse\r\n🐀 Rat\r\n🐹 Hamster\r\n\r\n🐇 Rabbit\r\n🐿️ Chipmunk\r\n🦫 Beaver\r\n🦔 Hedgehog\r\n🦇 Bat\r\n Bear\r\n🐻‍❄️ Polar Bear\r\n🐨 Koala\r\n🐼 Panda\r\n🦥 Sloth\r\n🦦 Otter\r\n🦨 Skunk\r\n🦘 Kangaroo\r\n🦡 Badger\r\n🐾 Paw Prints\r\n🦃 Turkey\r\n🐔 Chicken\r\n🐓 Rooster\r\n🐣 Hatching Chick\r\n🐤 Baby Chick\r\n🐥 Front-Facing Baby Chick\r\n🐦 Bird\r\n🐧 Penguin\r\n🕊️ Dove\r\n🦅 Eagle\r\n🦆 Duck\r\n🦢 Swan\r\n🦉 Owl\r\n🦤 Dodo\r\n🪶 Feather\r\n🦩 Flamingo\r\n🦚 Peacock\r\n🦜 Parrot\r\n\r\n🐊 Crocodile\r\n🐢 Turtle\r\n🦎 Lizard\r\n🐍 Snake\r\n🐲 Dragon Face\r\n🐉 Dragon\r\n🦕 Sauropod\r\n🦖 T-Rex\r\n🐳 Spouting Whale\r\n🐋 Whale\r\n🐬 Dolphin\r\n🦭 Seal\r\n🐟 Fish\r\n🐠 Tropical Fish\r\n🐡 Blowfish\r\n🦈 Shark\r\n🐙 Octopus\r\n🐚 Spiral Shell\r\n🐌 Snail\r\n🦋 Butterfly\r\n🐛 Bug\r\n🐜 Ant\r\n🐝 Honeybee\r\n🪲 Beetle\r\n🐞 Lady Beetle\r\n🦗 Cricket\r\n🪳 Cockroach\r\n🕷️ Spider\r\n🕸️ Spider Web\r\n🦂 Scorpion\r\n🦟 Mosquito\r\n🪰 Fly\r\n🪱 Worm\r\n🦠 Microbe\r\n💐 Bouquet\r\n🌸 Cherry Blossom\r\n💮 White Flower\r\n🏵️ Rosette\r\n🌹 Rose\r\n🥀 Wilted Flower\r\n🌺 Hibiscus\r\n🌻 Sunflower\r\n🌼 Blossom\r\n🌷 Tulip\r\n🌱 Seedling\r\n🪴 Potted Plant\r\n🌲 Evergreen Tree\r\n🌳 Deciduous Tree\r\n🌴 Palm Tree\r\n🌵 Cactus\r\n🌾 Sheaf of Rice\r\n🌿 Herb\r\n☘️ Shamrock\r\n🍀 Four Leaf Clover\r\n🍁 Maple Leaf\r\n🍂 Fallen Leaf\r\n🍃 Leaf Fluttering in Wind\r\n🍄 Mushroom\r\n🌰 Chestnut\r\n🦀 Crab\r\n🦞 Lobster\r\n🦐 Shrimp\r\n🦑 Squid\r\n🌍 Globe Showing Europe-Africa\r\n🌎 Globe Showing Americas\r\n🌏 Globe Showing Asia-Australia\r\n🌐 Globe with Meridians\r\n🪨 Rock\r\n🌑 New Moon\r\n🌒 Waxing Crescent Moon\r\n🌓 First Quarter Moon\r\n🌔 Waxing Gibbous Moon\r\n🌕 Full Moon\r\n🌖 Waning Gibbous Moon\r\n🌗 Last Quarter Moon\r\n🌘 Waning Crescent Moon\r\n🌙 Crescent Moon\r\n🌚 New Moon Face\r\n🌛 First Quarter Moon Face\r\n🌜 Last Quarter Moon Face\r\n☀️ Sun\r\n🌝 Full Moon Face\r\n🌞 Sun with Face\r\n⭐ Star\r\n🌟 Glowing Star\r\n🌠 Shooting Star\r\n☁️ Cloud\r\n⛅ Sun Behind Cloud\r\n⛈️ Cloud with Lightning and Rain\r\n🌤️ Sun Behind Small Cloud\r\n🌥️ Sun Behind Large Cloud\r\n🌦️ Sun Behind Rain Cloud\r\n🌧️ Cloud with Rain\r\n🌨️ Cloud with Snow\r\n🌩️ Cloud with Lightning\r\n🌪️ Tornado\r\n🌫️ Fog\r\n🌬️ Wind Face\r\n🌈 Rainbow\r\n☂️ Umbrella\r\n☔ Umbrella with Rain Drops\r\n⚡ High Voltage\r\n❄️ Snowflake\r\n☃️ Snowman\r\n⛄ Snowman Without Snow\r\n☄️ Comet\r\n🔥 Fire\r\n💧 Droplet\r\n🌊 Water Wave\r\n🎄 Christmas Tree\r\n✨ Sparkles\r\n🎋 Tanabata Tree\r\n🎍 Pine Decoration\r\n*/","const removeLoser = (losers,ballots) => {\r\n  //console.log(`advancing ballots for \"${losers[losers.length-1]}\"`);\r\n  const newBallots = ballots.map(ballot => {\r\n    var nextVotes = ballot.votes.slice(0);\r\n    while(losers.indexOf(nextVotes[0]) > -1 && nextVotes.length > 0){\r\n      nextVotes.shift();\r\n    }\r\n    //console.log(`nextVote=${nextVote} loser=${loser} same? = ${nextVote === loser}`);\r\n    return {...ballot, votes: nextVotes };\r\n  });\r\n\r\n  return newBallots.filter(b => b.votes.length > 0);\r\n};\r\n\r\nconst calculateLeaders = (votes) => {\r\n  let counted = votes.reduce((leaders, c) => {\r\n    let l = leaders[c] || 0;\r\n    leaders[c] = l + 1;\r\n    return leaders;\r\n  }, {});\r\n  return Object.entries(counted)\r\n    .map(([candidate, voteCount]) => ({\r\n      candidate: candidate === \"null\" ? null : candidate,\r\n      voteCount,\r\n      votePercentage: (voteCount / votes.length) * 100\r\n    }))\r\n    .sort((a, b) => b.voteCount - a.voteCount);\r\n};\r\n\r\nvar performInstantRunoff = (ballots, maxRunOffs) => {\r\n\tif(ballots.length === 0 ){\r\n\t\treturn [];\r\n\t}\r\n  var runOff = step => {\r\n    var losers = [...step.losers, step.leaders[step.leaders.length-1].candidate];\r\n    var nextBallots = removeLoser(losers,step.ballots);\r\n    var leaders = calculateLeaders(nextBallots.map(b => b.votes[0]));\r\n    return {\r\n      ballots: nextBallots,\r\n      losers,\r\n      leaders\r\n    };\r\n  };\r\n\r\n  var runOffs = [\r\n    {\r\n      ballots,\r\n      losers: [],\r\n      leaders: calculateLeaders(ballots.map(b => b.votes[0]))\r\n    }\r\n  ];\r\n  for(var i=0; i<maxRunOffs; i++){\r\n    var lastRound = runOffs[runOffs.length - 1];\r\n    if(!!lastRound.leaders[0] && lastRound.leaders[0].votePercentage < 50){\r\n      runOffs.push(runOff(lastRound));\r\n    }\r\n  }\r\n  return runOffs;\r\n};\r\n\r\nexport {performInstantRunoff};","const Candidate = (c) => (\r\n  <div\r\n    className=\"is-size-3 has-text-centered\"\r\n    style={{ display: \"inline-block\", width: \"1.33em\" }}\r\n  >\r\n    {!!c ? c : /*\"❓\"*/ \"🚫\"}\r\n  </div>\r\n);\r\nexport default Candidate;\r\n","import Candidate from \"./candidate\";\r\n\r\nconst BallotGrid = ({ ballots, onRemove }) => (\r\n  <div className=\"columns is-multiline\">\r\n    {ballots.map((b, i) => (\r\n      <div className=\"column m-0\" key={b.id}>\r\n        <div className=\"box p-3\">\r\n          <div className=\"level\">\r\n            <div className=\"level-left\">\r\n              <span className=\"tag\">{b.id}</span>\r\n              {b.votes.map(Candidate)}\r\n              {!!onRemove && (\r\n                <button\r\n                  className=\"delete\"\r\n                  title=\"Remove this ballot from the election\"\r\n                  onClick={() => onRemove(b.id)}\r\n                ></button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    ))}\r\n  </div>\r\n);\r\n\r\nexport default BallotGrid;\r\n","import Candidate from \"./candidate\";\r\nconst ResultMessage = ({ results }) => {\r\n  var finalResult = results[results.length - 1];\r\n  if (!finalResult) {\r\n    return <></>;\r\n  }\r\n  var finalLeader = finalResult.leaders[0];\r\n  if (!finalLeader) {\r\n    return <></>;\r\n  }\r\n  var decided = finalLeader.votePercentage > 50;\r\n  var runoff_intro = (\r\n    <>\r\n      After <strong>{results.length - 1}</strong> instant run-off\r\n      {results.length - 1 === 1 ? \"\" : \"s\"}\r\n    </>\r\n  );\r\n  return decided ? (\r\n    <article className=\"message is-success\">\r\n      <div className=\"message-header\">\r\n        <p>We have a winner!</p>\r\n      </div>\r\n      <div className=\"message-body\">\r\n        {runoff_intro}, this election goes to {Candidate(finalLeader.candidate)}\r\n        with {finalLeader.voteCount} votes (\r\n        {finalLeader.votePercentage.toFixed(2)}% of all votes)\r\n      </div>\r\n    </article>\r\n  ) : (\r\n    <article className=\"message is-danger\">\r\n      <div className=\"message-header\">\r\n        <p>Undecided</p>\r\n      </div>\r\n      <div className=\"message-body\">\r\n        {runoff_intro}, this election is undecided. Nobody got >50% of the vote!\r\n      </div>\r\n    </article>\r\n  );\r\n};\r\nexport default ResultMessage;\r\n","import Candidate from \"./candidate\";\r\nconst LeaderBoard = ({ leaders }) => (\r\n  <table className=\"table is-striped is-bordered has-text-centered\">\r\n    <thead>\r\n      <tr>\r\n        <th>Place</th>\r\n        <th>Candidate</th>\r\n        <th>Votes</th>\r\n        <th>%</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      {leaders.map((l, i) => (\r\n        <tr key={i}>\r\n          <td>{i + 1}</td>\r\n          <td>{Candidate(l.candidate)}</td>\r\n          <td>{l.voteCount}</td>\r\n          <td>{l.votePercentage.toFixed(1)}</td>\r\n        </tr>\r\n      ))}\r\n    </tbody>\r\n  </table>\r\n);\r\nexport default LeaderBoard;\r\n","import React from \"react\";\r\nimport BallotDemoData from \"./ballot-demo-data\";\r\nimport { performInstantRunoff } from \"./instant-runoff\";\r\nimport { LeaderBoard, Candidate, BallotGrid, ResultMessage } from \"./ui\";\r\n\r\nconst arrayWithoutItemAtIndex = (arr, ix) => [\r\n  ...arr.slice(0, ix),\r\n  ...arr.slice(ix + 1)\r\n];\r\n\r\nexport default function App() {\r\n  var availableCandidates = \"🐸,🐰,🐙,🐵,🐼,🦊,🐴,🐮,🐶,🐭\".split(\",\");\r\n  const [candidatesAvailable, setCandidatesAvailable] = React.useState(\r\n    Object.fromEntries(availableCandidates.slice(0, 3).map((c) => [c, true]))\r\n  );\r\n  const candidates = availableCandidates.filter((c) => candidatesAvailable[c]);\r\n  const [choiceCount, setChoiceCount] = React.useState(2);\r\n  const removeBallotById = (idToRemove) => {\r\n    let index = ballots.findIndex((b) => b.id === idToRemove);\r\n    if (index === -1) {\r\n      return;\r\n    }\r\n    setBallots(arrayWithoutItemAtIndex(ballots, index));\r\n    setUndos([...undos, () => setBallots(ballots)]);\r\n  };\r\n\r\n  const [undos, setUndos] = React.useState([]);\r\n  const undo = () => {\r\n    let undofn = undos.slice().pop();\r\n    if (!undofn) {\r\n      return;\r\n    }\r\n    undofn();\r\n    setUndos(undos.slice(0, -1));\r\n  };\r\n  const genBallots = () =>\r\n    BallotDemoData.simpleRandom(choiceCount, 200, candidates);\r\n  const [ballots, setBallots] = React.useState([]);\r\n  var results = performInstantRunoff(ballots, 10);\r\n  const [tabId, setTabId] = React.useState(0);\r\n\r\n  React.useEffect(() => {\r\n    setTabId(results.length - 1);\r\n  }, [ballots, results.length]);\r\n\r\n  const reset = () => {\r\n    setBallots(genBallots());\r\n  };\r\n  return (\r\n    <div className=\"container is-fluid\">\r\n      <h1 className=\"title\">Ranked Choice Voting</h1>\r\n      <div className=\"content\">\r\n        Experiment with this simulator to better understand Ranked Choice Voting\r\n        (RCV) and instant run-off elections for single-winner races.{\" \"}\r\n        <a\r\n          href=\"https://www.fairvote.org/how_rcv_works\"\r\n          target=\"_blank\"\r\n          rel=\"noreferrer\"\r\n        >\r\n          More information\r\n          <span className=\"icon\" role=\"img\" aria-label=\"external link\">\r\n            ↗\r\n          </span>\r\n        </a>\r\n      </div>\r\n      <div className=\"box\">\r\n        <div className=\"level\">\r\n          <div>\r\n            <strong># of Choices on ballot</strong>\r\n            <br />\r\n            <input\r\n              className=\"mr-2\"\r\n              type=\"range\"\r\n              min=\"1\"\r\n              max=\"3\"\r\n              value={choiceCount}\r\n              onChange={(e) => setChoiceCount(parseInt(e.target.value, 10))}\r\n            />\r\n            {choiceCount}\r\n            {choiceCount === 1 && (\r\n              <div>\r\n                <span className=\"icon\" role=\"img\" aria-label=\"info\">\r\n                  ℹ️\r\n                </span>\r\n                Traditional elections allow voters only a single choice. Enable\r\n                2 choices or more for a more interesting instant run-off\r\n                election.\r\n              </div>\r\n            )}\r\n          </div>\r\n          <div>\r\n            <strong>Available Candidates</strong>\r\n            <div className=\"is-flex\">\r\n              {availableCandidates.map((c) => (\r\n                <label className=\"checkbox has-text-centered\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={candidatesAvailable[c]}\r\n                    onChange={(e) =>\r\n                      setCandidatesAvailable({\r\n                        ...candidatesAvailable,\r\n                        [c]: !candidatesAvailable[c]\r\n                      })\r\n                    }\r\n                  />\r\n                  <div>{Candidate(c)}</div>\r\n                </label>\r\n              ))}\r\n            </div>\r\n            {candidates.length < 3 && (\r\n              <div>\r\n                <span className=\"icon\" role=\"img\" aria-label=\"info\">\r\n                  ℹ️\r\n                </span>\r\n                In traditional elections, it often feels like only 2 candidates\r\n                matter. Select at least 3 candidates for a more interesting\r\n                instant run-off election\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <button className=\"button is-primary\" onClick={reset}>\r\n            Generate random ballots\r\n          </button>\r\n        </div>\r\n      </div>\r\n      {results.length > 0 && (\r\n        <>\r\n          <ResultMessage results={results} />\r\n\r\n          <div class=\"tabs is-toggle\">\r\n            <ul>\r\n              {results.map((r, id) => (\r\n                <li className={tabId === id ? \"is-active\" : \"\"} key={id}>\r\n                  <a onClick={() => setTabId(id)}>\r\n                    {id === 0 ? \"Original results\" : `Instant Run-off #${id}`}\r\n                    {id === results.length - 1 ? \" (Final)\" : \"\"}\r\n                  </a>\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          </div>\r\n\r\n          {[results[tabId]]\r\n            .filter((r) => !!r)\r\n            .map((r, i) => (\r\n              <div key={i}>\r\n                <p className=\"mb-5\">\r\n                  Ballots considered VALID at this stage = {r.ballots.length}{\" \"}\r\n                  out of {results[0].ballots.length}\r\n                </p>\r\n                <LeaderBoard leaders={r.leaders} />\r\n                {!!r.losers.length && (\r\n                  <p className=\"mb-5\">\r\n                    Candidates eliminated from previous steps ={\" \"}\r\n                    {r.losers.map(Candidate)}\r\n                  </p>\r\n                )}\r\n                <button\r\n                  className=\"button is-text\"\r\n                  onClick={undo}\r\n                  disabled={undos.length === 0}\r\n                >\r\n                  undo\r\n                </button>\r\n                <BallotGrid ballots={r.ballots} onRemove={removeBallotById} />\r\n              </div>\r\n            ))}\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import { StrictMode } from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\nimport App from \"./App\";\r\n\r\nconst rootElement = document.getElementById(\"root\");\r\nReactDOM.render(\r\n  <StrictMode>\r\n    <App />\r\n  </StrictMode>,\r\n  rootElement\r\n);\r\n"],"sourceRoot":""}