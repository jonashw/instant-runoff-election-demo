{"version":3,"sources":["ballot-demo-data.js","instant-runoff.js","candidate.js","ballot-grid.js","result-message.js","leader-board.js","App.js","index.js"],"names":["simpleRandom","split","slice","choiceCount","ballotCount","candidates","idLength","toString","length","Array","fill","map","_","i","votes","reduce","state","Math","floor","random","availableCandidates","splice","selectedCandidate","push","id","padStart","calculateLeaders","counted","leaders","c","l","Object","entries","candidate","voteCount","votePercentage","sort","a","b","performInstantRunoff","ballots","maxRunOffs","runOff","step","losers","nextBallots","ballot","nextVotes","indexOf","shift","filter","removeLoser","stages","lastRound","winner","undefined","finalLeader","fromBehind","Candidate","className","style","display","width","BallotGrid","onRemove","title","onClick","ResultMessage","result","runoff_intro","toFixed","LeaderBoard","QuickInfo","children","role","App","allCandidates","defaultSettings","candidatesInTheRunning","fromEntries","React","useState","settings","setSettings","setResult","tabId","setTabId","href","target","rel","fn","predicate","maxTries","tries","console","log","applyUntil","BallotDemoData","r","type","checked","onChange","e","min","max","value","parseInt","rootElement","document","getElementById","ReactDOM","render"],"mappings":"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","file":"static/js/main.6cf4609d.chunk.js","sourcesContent":["var candidates = \"🐸,🐰,🐙,🐵,🐼,🦊,🐴,\".split(\",\").slice(0, 6);\n//🐮,🐶,,🐭\nvar simpleRandom = (choiceCount, ballotCount, candidates) => {\n\tconst idLength = ballotCount.toString().length;\n\treturn Array(ballotCount)\n\t\t.fill()\n\t\t.map(\n\t\t\t(_, i) => {\n\t\t\t\tvar votes = Array(choiceCount)\n\t\t\t\t\t.fill()\n\t\t\t\t\t.reduce(\n\t\t\t\t\t\t(state) => {\n\t\t\t\t\t\t\tlet i = Math.floor(\n\t\t\t\t\t\t\t\tMath.random() * state.availableCandidates.length\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tlet [selectedCandidate] = \n\t\t\t\t\t\t\t\tMath.random() < 0.0\n\t\t\t\t\t\t\t\t? ['']\n\t\t\t\t\t\t\t\t//a voter may not vote for any one candidate more than once.\n\t\t\t\t\t\t\t\t: state.availableCandidates.splice(i, 1);\n\t\t\t\t\t\t\tstate.votes.push(selectedCandidate);\n\t\t\t\t\t\t\treturn state;\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvotes: [],\n\t\t\t\t\t\t\tavailableCandidates: candidates.slice(0)\n\t\t\t\t\t\t}\n\t\t\t\t\t).votes;\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: (i+1).toString().padStart(idLength,\"0\"),\n\t\t\t\t\t\tvotes\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n}\nvar emojiAnimals = (choiceCount, ballotCount) => simpleRandom(choiceCount, ballotCount, candidates);\n\nexport default {\n\temojiAnimals,\n\tsimpleRandom\n};\n\n/*\n\n🐻🐱🐯🐷\n🙈 See-No-Evil Monkey\n🙉 Hear-No-Evil Monkey\n🙊 Speak-No-Evil Monkey\n🐒 Monkey\n🦍 Gorilla\n🦧 Orangutan\n🐶 Dog Face\n🐕 Dog\n🦮 Guide Dog\n🐕‍🦺 Service Dog\n🐩 Poodle\n🐺 Wolf\n🦊 Fox\n🦝 Raccoon\n🐱 Cat Face\n🐈 Cat\n🐈‍⬛ Black Cat\n🦁 Lion\n🐯 Tiger Face\n🐅 Tiger\n🐆 Leopard\n🐴 Horse Face\n🐎 Horse\n🦄 Unicorn\n🦓 Zebra\n🦌 Deer\n🦬 Bison\n Cow Face\n🐂 Ox\n🐃 Water Buffalo\n🐄 Cow\n🐖 Pig\n🐗 Boar\n🐽 Pig Nose\n🐏 Ram\n🐑 Ewe\n🐐 Goat\n🐪 Camel\n🐫 Two-Hump Camel\n🦙 Llama\n🦒 Giraffe\n🐘 Elephant\n🦣 Mammoth\n🦏 Rhinoceros\n🦛 Hippopotamus\n🐭 Mouse Face\n🐁 Mouse\n🐀 Rat\n🐹 Hamster\n\n🐇 Rabbit\n🐿️ Chipmunk\n🦫 Beaver\n🦔 Hedgehog\n🦇 Bat\n Bear\n🐻‍❄️ Polar Bear\n🐨 Koala\n🐼 Panda\n🦥 Sloth\n🦦 Otter\n🦨 Skunk\n🦘 Kangaroo\n🦡 Badger\n🐾 Paw Prints\n🦃 Turkey\n🐔 Chicken\n🐓 Rooster\n🐣 Hatching Chick\n🐤 Baby Chick\n🐥 Front-Facing Baby Chick\n🐦 Bird\n🐧 Penguin\n🕊️ Dove\n🦅 Eagle\n🦆 Duck\n🦢 Swan\n🦉 Owl\n🦤 Dodo\n🪶 Feather\n🦩 Flamingo\n🦚 Peacock\n🦜 Parrot\n\n🐊 Crocodile\n🐢 Turtle\n🦎 Lizard\n🐍 Snake\n🐲 Dragon Face\n🐉 Dragon\n🦕 Sauropod\n🦖 T-Rex\n🐳 Spouting Whale\n🐋 Whale\n🐬 Dolphin\n🦭 Seal\n🐟 Fish\n🐠 Tropical Fish\n🐡 Blowfish\n🦈 Shark\n🐙 Octopus\n🐚 Spiral Shell\n🐌 Snail\n🦋 Butterfly\n🐛 Bug\n🐜 Ant\n🐝 Honeybee\n🪲 Beetle\n🐞 Lady Beetle\n🦗 Cricket\n🪳 Cockroach\n🕷️ Spider\n🕸️ Spider Web\n🦂 Scorpion\n🦟 Mosquito\n🪰 Fly\n🪱 Worm\n🦠 Microbe\n💐 Bouquet\n🌸 Cherry Blossom\n💮 White Flower\n🏵️ Rosette\n🌹 Rose\n🥀 Wilted Flower\n🌺 Hibiscus\n🌻 Sunflower\n🌼 Blossom\n🌷 Tulip\n🌱 Seedling\n🪴 Potted Plant\n🌲 Evergreen Tree\n🌳 Deciduous Tree\n🌴 Palm Tree\n🌵 Cactus\n🌾 Sheaf of Rice\n🌿 Herb\n☘️ Shamrock\n🍀 Four Leaf Clover\n🍁 Maple Leaf\n🍂 Fallen Leaf\n🍃 Leaf Fluttering in Wind\n🍄 Mushroom\n🌰 Chestnut\n🦀 Crab\n🦞 Lobster\n🦐 Shrimp\n🦑 Squid\n🌍 Globe Showing Europe-Africa\n🌎 Globe Showing Americas\n🌏 Globe Showing Asia-Australia\n🌐 Globe with Meridians\n🪨 Rock\n🌑 New Moon\n🌒 Waxing Crescent Moon\n🌓 First Quarter Moon\n🌔 Waxing Gibbous Moon\n🌕 Full Moon\n🌖 Waning Gibbous Moon\n🌗 Last Quarter Moon\n🌘 Waning Crescent Moon\n🌙 Crescent Moon\n🌚 New Moon Face\n🌛 First Quarter Moon Face\n🌜 Last Quarter Moon Face\n☀️ Sun\n🌝 Full Moon Face\n🌞 Sun with Face\n⭐ Star\n🌟 Glowing Star\n🌠 Shooting Star\n☁️ Cloud\n⛅ Sun Behind Cloud\n⛈️ Cloud with Lightning and Rain\n🌤️ Sun Behind Small Cloud\n🌥️ Sun Behind Large Cloud\n🌦️ Sun Behind Rain Cloud\n🌧️ Cloud with Rain\n🌨️ Cloud with Snow\n🌩️ Cloud with Lightning\n🌪️ Tornado\n🌫️ Fog\n🌬️ Wind Face\n🌈 Rainbow\n☂️ Umbrella\n☔ Umbrella with Rain Drops\n⚡ High Voltage\n❄️ Snowflake\n☃️ Snowman\n⛄ Snowman Without Snow\n☄️ Comet\n🔥 Fire\n💧 Droplet\n🌊 Water Wave\n🎄 Christmas Tree\n✨ Sparkles\n🎋 Tanabata Tree\n🎍 Pine Decoration\n*/","const removeLoser = (losers,ballots) => {\n  //console.log(`advancing ballots for \"${losers[losers.length-1]}\"`);\n  const newBallots = ballots.map(ballot => {\n    var nextVotes = ballot.votes.slice(0);\n    while(losers.indexOf(nextVotes[0]) > -1 && nextVotes.length > 0){\n      nextVotes.shift();\n    }\n    //console.log(`nextVote=${nextVote} loser=${loser} same? = ${nextVote === loser}`);\n    return {...ballot, votes: nextVotes };\n  });\n\n  return newBallots.filter(b => b.votes.length > 0);\n};\n\nconst calculateLeaders = (votes) => {\n  let counted = votes.reduce((leaders, c) => {\n    let l = leaders[c] || 0;\n    leaders[c] = l + 1;\n    return leaders;\n  }, {});\n  return Object.entries(counted)\n    .map(([candidate, voteCount]) => ({\n      candidate: candidate === \"null\" ? null : candidate,\n      voteCount,\n      votePercentage: (voteCount / votes.length) * 100\n    }))\n    .sort((a, b) => b.voteCount - a.voteCount);\n};\n\nvar performInstantRunoff = (ballots, maxRunOffs) => {\n\tif(ballots.length === 0 ){\n\t\treturn [];\n\t}\n  var runOff = step => {\n    var losers = [...step.losers, step.leaders[step.leaders.length-1].candidate];\n    var nextBallots = removeLoser(losers,step.ballots);\n    var leaders = calculateLeaders(nextBallots.map(b => b.votes[0]));\n    return {\n      ballots: nextBallots,\n      losers,\n      leaders\n    };\n  };\n\n  var stages = [\n    {\n      ballots,\n      losers: [],\n      leaders: calculateLeaders(ballots.map(b => b.votes[0]))\n    }\n  ];\n  for(var i=0; i<maxRunOffs; i++){\n    var lastRound = stages[stages.length - 1];\n    if(!!lastRound.leaders[0] && lastRound.leaders[0].votePercentage < 50){\n      stages.push(runOff(lastRound));\n    }\n  }\n\n\tvar winner = undefined;\n  if (stages.length > 0) {\n\t\tvar finalStage = stages[stages.length - 1];\n\t\tvar finalLeader = finalStage.leaders[0];\n\t\tif (finalLeader && finalLeader.votePercentage > 50) {\n\t\t\twinner = {\n\t\t\t\t...finalLeader,\n\t\t\t\tfromBehind: stages[0].leaders[0].candidate !== finalLeader.candidate\n\t\t\t}\n\t\t}\n  }\n\treturn {\n\t\tstages,\n\t\twinner\n\t};\n};\n\nexport {performInstantRunoff};","const Candidate = (c) => (\n  <div\n    key={c}\n    className=\"is-size-3 has-text-centered\"\n    style={{ display: \"inline-block\", width: \"1.33em\" }}\n  >\n    {!!c ? c : /*\"❓\"*/ \"🚫\"}\n  </div>\n);\nexport default Candidate;\n","import Candidate from \"./candidate\";\n\nconst BallotGrid = ({ ballots, onRemove }) => (\n  <div className=\"columns is-multiline\">\n    {ballots.map((b, i) => (\n      <div className=\"column m-0\" key={b.id}>\n        <div className=\"box p-3\">\n          <div className=\"level\">\n            <div className=\"level-left\">\n              <span className=\"tag\">#{b.id}</span>\n              {b.votes.map(Candidate)}\n              {!!onRemove && (\n                <button\n                  className=\"delete\"\n                  title=\"Remove this ballot from the election\"\n                  onClick={() => onRemove(b.id)}\n                ></button>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    ))}\n  </div>\n);\n\nexport default BallotGrid;\n","import Candidate from \"./candidate\";\nconst ResultMessage = ({ result }) => {\n  var runoff_intro = (\n    <>\n      After <strong>{result.stages.length - 1}</strong> instant run-off\n      {result.stages.length - 1 === 1 ? \"\" : \"s\"}\n    </>\n  );\n  return !!result.winner ? (\n    <article className=\"message is-success\">\n      <div className=\"message-header\">\n        <p>We have a winner!</p>\n      </div>\n      <div className=\"message-body\">\n        {runoff_intro}, this election goes to {Candidate(result.winner.candidate)}\n        with {result.winner.voteCount} votes (\n        {result.winner.votePercentage.toFixed(2)}% of all votes).\n        {result.winner.fromBehind && <strong className=\"ml-2\">This candidate came from behind!</strong>}\n      </div>\n    </article>\n  ) : (\n    <article className=\"message is-danger\">\n      <div className=\"message-header\">\n        <p>Undecided</p>\n      </div>\n      <div className=\"message-body\">\n        {runoff_intro}, this election is undecided. Nobody got &gt;50% of the vote!\n      </div>\n    </article>\n  );\n};\nexport default ResultMessage;\n","import Candidate from \"./candidate\";\nconst LeaderBoard = ({ leaders }) => (\n  <table className=\"table is-striped is-bordered has-text-centered\">\n    <thead>\n      <tr>\n        <th>Place</th>\n        <th>Candidate</th>\n        <th>Votes</th>\n        <th>%</th>\n      </tr>\n    </thead>\n    <tbody>\n      {leaders.map((l, i) => (\n        <tr key={i}>\n          <td>{i + 1}</td>\n          <td>{Candidate(l.candidate)}</td>\n          <td>{l.voteCount}</td>\n          <td>{l.votePercentage.toFixed(1)}</td>\n        </tr>\n      ))}\n    </tbody>\n  </table>\n);\nexport default LeaderBoard;\n","import React from \"react\";\nimport BallotDemoData from \"./ballot-demo-data\";\nimport { performInstantRunoff } from \"./instant-runoff\";\nimport { LeaderBoard, Candidate, BallotGrid, ResultMessage } from \"./ui\";\n\nconst arrayWithoutItemAtIndex = (arr, ix) => [\n  ...arr.slice(0, ix),\n  ...arr.slice(ix + 1)\n];\n\nconst applyUntil = (fn,predicate,maxTries) => {\n  var tries=0;\n  var result;\n  while(tries < maxTries) {\n    tries++;\n    console.log('try #' + tries);\n    result = fn();\n    if(predicate(result)){\n      return result;\n    }\n  } \n  return result;\n};\n\nconst QuickInfo = ({children}) =>\n  <article className=\"message is-info\">\n    <div className=\"message-body\">\n      <span className=\"icon\" role=\"img\" aria-label=\"info\">\n        ℹ️\n      </span>\n      {children}\n    </div>\n  </article>;\n\nexport default function App() {\n  var allCandidates = \"🐸,🐰,🐙,🐵,🐼,🦊,🐴,🐮,🐶,🐭\".split(\",\");\n  const defaultSettings = () => ({\n    candidatesInTheRunning: Object.fromEntries(allCandidates.map((c,i) => [c, i <= 2])),\n    ballotCount: 200\n  });\n  const [settings, setSettings] = React.useState(defaultSettings());\n  const candidates = allCandidates.filter((c) => settings.candidatesInTheRunning[c]);\n  const genBallots = () => BallotDemoData.simpleRandom(candidates.length, settings.ballotCount, candidates);\n  const [result, setResult] = React.useState(undefined);\n  const [tabId, setTabId] = React.useState(0);\n\n  const reset = () => {\n    setResult(null);\n    setSettings(defaultSettings());\n  }\n\n  const generate = () => {\n    //it's most interesting to see a candidate emerge from behind in a run-off...\n    var result = applyUntil(\n      () => performInstantRunoff(genBallots(), 10),\n      r => !!r.winner && r.winner.fromBehind,\n      2\n    );\n    setResult(result);\n    setTabId(result.stages.length - 1);\n  };\n\n  return (\n    <div className=\"container is-fluid mt-5\">\n      <a href=\"https://forms.gle/4m8ih2JKVVZCKtq96\" target=\"_blank\" className=\"button is-info is-pulled-right\">\n        <span className=\"icon-text\">\n          <span className=\"icon mr-1\">👍</span>\n          Give feedback\n          <span className=\"icon ml-1\">👎</span>\n        </span>\n      </a>\n      <h1 className=\"title\">Ranked Choice Voting Simulator</h1>\n      <div className=\"content\">\n        Experiment with this simulator to better understand Ranked Choice Voting\n        (RCV) and instant run-off elections for single-winner races.{\" \"}\n        <a\n          href=\"https://www.fairvote.org/how_rcv_works\"\n          target=\"_blank\"\n          rel=\"noreferrer\"\n        >\n          More information\n          <span className=\"icon\" role=\"img\" aria-label=\"external link\">\n            ↗\n          </span>\n        </a>\n      </div>\n      <hr/>\n      <div>\n        <div className=\"level\">\n          <div>\n            <button className=\"button is-primary is-large\" onClick={generate}>\n              Simulate election\n            </button>\n            {!!result && <div className=\"has-text-centered\">\n              <button className=\"button is-text\" onClick={reset}>\n                Reset\n              </button>\n            </div>}\n          </div>\n          <div>\n            <strong>Candidates in the running</strong>\n            <div className=\"is-flex\">\n              {allCandidates.map((c) => (\n                <label key={c} className=\"checkbox has-text-centered\">\n                  <input\n                    type=\"checkbox\"\n                    checked={settings.candidatesInTheRunning[c]}\n                    onChange={(e) =>\n                      setSettings({\n                        ...settings,\n                        candidatesInTheRunning: {\n                          ...settings.candidatesInTheRunning,\n                          [c]: !settings.candidatesInTheRunning[c]\n                        }\n                      })\n                    }\n                  />\n                  <div>{Candidate(c)}</div>\n                </label>\n              ))}\n            </div>\n          </div>\n          <div>\n            <strong>Number of voters to simulate</strong>\n            <br />\n            <input\n              className=\"mr-2\"\n              type=\"range\"\n              step=\"50\"\n              min=\"50\"\n              max=\"1000\"\n              value={settings.ballotCount}\n              onChange={(e) => setSettings({...settings, ballotCount: parseInt(e.target.value, 10)})}\n            />\n            {settings.ballotCount}\n          </div>\n        </div>\n        \n        {candidates.length < 3 && (\n          <QuickInfo>\n            In traditional elections, it often feels like only 2 candidates\n            matter.{\" \"}\n            <strong>\n              Select at least 3 candidates for a more interesting instant run-off election\n            </strong>\n          </QuickInfo>\n        )}\n      </div>\n\n\n      {!!result && (\n        <>\n          <hr/>\n          <ResultMessage result={result} />\n\n          <div className=\"tabs is-toggle\">\n            <ul>\n              {result.stages.map((r, id) => (\n                <li className={tabId === id ? \"is-active\" : \"\"} key={id}>\n                  <a onClick={() => setTabId(id)}>\n                    {id === 0 ? \"Original results\" : `Instant Run-off #${id}`}\n                    {id === result.stages.length - 1 ? \" (Final)\" : \"\"}\n                  </a>\n                </li>\n              ))}\n            </ul>\n          </div>\n\n          {[result.stages[tabId]]\n            .filter((r) => !!r)\n            .map((r, i) => (\n              <div key={i}>\n                <div className=\"mb-5\">\n                  Ballots considered VALID at this stage = {r.ballots.length}{\" \"}\n                  out of {result.stages[0].ballots.length}\n                </div>\n                <LeaderBoard leaders={r.leaders} />\n                {!!r.losers.length && (\n                  <div className=\"mb-5\">\n                    Candidates eliminated in previous stages :{\" \"}\n                    {r.losers.map(Candidate)}\n                  </div>\n                )}\n                <p className=\"mb-5\">Ballots as of this stage (with eliminated candidates removed):</p>\n                <BallotGrid ballots={r.ballots}/>\n              </div>\n            ))}\n        </>\n      )}\n    </div>\n  );\n}\n","import { StrictMode } from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport App from \"./App\";\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(\n  <StrictMode>\n    <App />\n  </StrictMode>,\n  rootElement\n);\n"],"sourceRoot":""}