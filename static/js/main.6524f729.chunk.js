(this["webpackJsonpinstant-runoff-election"]=this["webpackJsonpinstant-runoff-election"]||[]).push([[0],{15:function(e,t,n){"use strict";n.r(t);var s=n(1),c=n.n(s),a=n(9),r=n.n(a),i=n(6),l=n(3),o=n(2),d=n(4),j=("\ud83d\udc38,\ud83d\udc30,\ud83d\udc19,\ud83d\udc35,\ud83d\udc3c,\ud83e\udd8a,\ud83d\udc34,".split(",").slice(0,6),function(e,t,n){var s=t.toString().length;return Array(t).fill().map((function(t,c){var a=Array(e).fill().reduce((function(e){var t=Math.floor(Math.random()*e.availableCandidates.length),n=Math.random()<0?[""]:e.availableCandidates.splice(t,1),s=Object(o.a)(n,1)[0];return e.votes.push(s),e}),{votes:[],availableCandidates:n.slice(0)}).votes;return{id:(c+1).toString().padStart(s,"0"),votes:a}}))}),b=j,u=function(e){var t=e.reduce((function(e,t){var n=e[t]||0;return e[t]=n+1,e}),{});return Object.entries(t).map((function(t){var n=Object(o.a)(t,2),s=n[0],c=n[1];return{candidate:"null"===s?null:s,voteCount:c,votePercentage:c/e.length*100}})).sort((function(e,t){return t.voteCount-e.voteCount}))},h=function(e,t){if(0===e.length)return[];for(var n=function(e){var t=[].concat(Object(d.a)(e.losers),[e.leaders[e.leaders.length-1].candidate]),n=function(e,t){return t.map((function(t){for(var n=t.votes.slice(0);e.indexOf(n[0])>-1&&n.length>0;)n.shift();return Object(l.a)(Object(l.a)({},t),{},{votes:n})})).filter((function(e){return e.votes.length>0}))}(t,e.ballots),s=u(n.map((function(e){return e.votes[0]})));return{ballots:n,losers:t,leaders:s}},s=[{ballots:e,losers:[],leaders:u(e.map((function(e){return e.votes[0]})))}],c=0;c<t;c++){var a=s[s.length-1];a.leaders[0]&&a.leaders[0].votePercentage<50&&s.push(n(a))}return s},f=n(0),O=function(e){return Object(f.jsx)("div",{className:"is-size-3 has-text-centered",style:{display:"inline-block",width:"1.33em"},children:e||"\ud83d\udeab"})},m=function(e){var t=e.ballots,n=e.onRemove;return Object(f.jsx)("div",{className:"columns is-multiline",children:t.map((function(e,t){return Object(f.jsx)("div",{className:"column m-0",children:Object(f.jsx)("div",{className:"box p-3",children:Object(f.jsx)("div",{className:"level",children:Object(f.jsxs)("div",{className:"level-left",children:[Object(f.jsx)("span",{className:"tag",children:e.id}),e.votes.map(O),!!n&&Object(f.jsx)("button",{className:"delete",title:"Remove this ballot from the election",onClick:function(){return n(e.id)}})]})})})},e.id)}))})},x=function(e){var t=e.results,n=t[t.length-1];if(!n)return Object(f.jsx)(f.Fragment,{});var s=n.leaders[0];if(!s)return Object(f.jsx)(f.Fragment,{});var c=s.votePercentage>50,a=Object(f.jsxs)(f.Fragment,{children:["After ",Object(f.jsx)("strong",{children:t.length-1})," instant run-off",t.length-1===1?"":"s"]});return c?Object(f.jsxs)("article",{className:"message is-success",children:[Object(f.jsx)("div",{className:"message-header",children:Object(f.jsx)("p",{children:"We have a winner!"})}),Object(f.jsxs)("div",{className:"message-body",children:[a,", this election goes to ",O(s.candidate),"with ",s.voteCount," votes (",s.votePercentage.toFixed(2),"% of all votes)"]})]}):Object(f.jsxs)("article",{className:"message is-danger",children:[Object(f.jsx)("div",{className:"message-header",children:Object(f.jsx)("p",{children:"Undecided"})}),Object(f.jsxs)("div",{className:"message-body",children:[a,", this election is undecided. Nobody got >50% of the vote!"]})]})},v=function(e){var t=e.leaders;return Object(f.jsxs)("table",{className:"table is-striped is-bordered has-text-centered",children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{children:"Place"}),Object(f.jsx)("th",{children:"Candidate"}),Object(f.jsx)("th",{children:"Votes"}),Object(f.jsx)("th",{children:"%"})]})}),Object(f.jsx)("tbody",{children:t.map((function(e,t){return Object(f.jsxs)("tr",{children:[Object(f.jsx)("td",{children:t+1}),Object(f.jsx)("td",{children:O(e.candidate)}),Object(f.jsx)("td",{children:e.voteCount}),Object(f.jsx)("td",{children:e.votePercentage.toFixed(1)})]},t)}))})]})};function g(){var e="\ud83d\udc38,\ud83d\udc30,\ud83d\udc19,\ud83d\udc35,\ud83d\udc3c,\ud83e\udd8a,\ud83d\udc34,\ud83d\udc2e,\ud83d\udc36,\ud83d\udc2d".split(","),t=c.a.useState(Object.fromEntries(e.slice(0,3).map((function(e){return[e,!0]})))),n=Object(o.a)(t,2),s=n[0],a=n[1],r=e.filter((function(e){return s[e]})),j=c.a.useState(2),u=Object(o.a)(j,2),g=u[0],p=u[1],N=function(e){var t,n,s=I.findIndex((function(t){return t.id===e}));-1!==s&&(P((t=I,n=s,[].concat(Object(d.a)(t.slice(0,n)),Object(d.a)(t.slice(n+1))))),w([].concat(Object(d.a)(y),[function(){return P(I)}])))},C=c.a.useState([]),k=Object(o.a)(C,2),y=k[0],w=k[1],S=function(){var e=y.slice().pop();e&&(e(),w(y.slice(0,-1)))},F=c.a.useState([]),R=Object(o.a)(F,2),I=R[0],P=R[1],A=h(I,10),E=c.a.useState(0),M=Object(o.a)(E,2),V=M[0],_=M[1];c.a.useEffect((function(){_(A.length-1)}),[I,A.length]);return Object(f.jsxs)("div",{className:"container is-fluid",children:[Object(f.jsx)("h1",{className:"title",children:"Ranked Choice Voting"}),Object(f.jsxs)("div",{className:"content",children:["Experiment with this simulator to better understand Ranked Choice Voting (RCV) and instant run-off elections for single-winner races."," ",Object(f.jsxs)("a",{href:"https://www.fairvote.org/how_rcv_works",target:"_blank",rel:"noreferrer",children:["More information",Object(f.jsx)("span",{className:"icon",role:"img","aria-label":"external link",children:"\u2197"})]})]}),Object(f.jsx)("div",{className:"box",children:Object(f.jsxs)("div",{className:"level",children:[Object(f.jsxs)("div",{children:[Object(f.jsx)("strong",{children:"# of Choices on ballot"}),Object(f.jsx)("br",{}),Object(f.jsx)("input",{className:"mr-2",type:"range",min:"1",max:"3",value:g,onChange:function(e){return p(parseInt(e.target.value,10))}}),g,1===g&&Object(f.jsxs)("div",{children:[Object(f.jsx)("span",{className:"icon",role:"img","aria-label":"info",children:"\u2139\ufe0f"}),"Traditional elections allow voters only a single choice. Enable 2 choices or more for a more interesting instant run-off election."]})]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("strong",{children:"Available Candidates"}),Object(f.jsx)("div",{className:"is-flex",children:e.map((function(e){return Object(f.jsxs)("label",{className:"checkbox has-text-centered",children:[Object(f.jsx)("input",{type:"checkbox",checked:s[e],onChange:function(t){return a(Object(l.a)(Object(l.a)({},s),{},Object(i.a)({},e,!s[e])))}}),Object(f.jsx)("div",{children:O(e)})]})}))}),r.length<3&&Object(f.jsxs)("div",{children:[Object(f.jsx)("span",{className:"icon",role:"img","aria-label":"info",children:"\u2139\ufe0f"}),"In traditional elections, it often feels like only 2 candidates matter. Select at least 3 candidates for a more interesting instant run-off election"]})]}),Object(f.jsx)("button",{className:"button is-primary",onClick:function(){P(b(g,200,r))},children:"Generate random ballots"})]})}),A.length>0&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(x,{results:A}),Object(f.jsx)("div",{class:"tabs is-toggle",children:Object(f.jsx)("ul",{children:A.map((function(e,t){return Object(f.jsx)("li",{className:V===t?"is-active":"",children:Object(f.jsxs)("a",{onClick:function(){return _(t)},children:[0===t?"Original results":"Instant Run-off #".concat(t),t===A.length-1?" (Final)":""]})},t)}))})}),[A[V]].filter((function(e){return!!e})).map((function(e,t){return Object(f.jsxs)("div",{children:[Object(f.jsxs)("p",{className:"mb-5",children:["Ballots considered VALID at this stage = ",e.ballots.length," ","out of ",A[0].ballots.length]}),Object(f.jsx)(v,{leaders:e.leaders}),!!e.losers.length&&Object(f.jsxs)("p",{className:"mb-5",children:["Candidates eliminated from previous steps ="," ",e.losers.map(O)]}),Object(f.jsx)("button",{className:"button is-text",onClick:S,disabled:0===y.length,children:"undo"}),Object(f.jsx)(m,{ballots:e.ballots,onRemove:N})]},t)}))]})]})}var p=document.getElementById("root");r.a.render(Object(f.jsx)(s.StrictMode,{children:Object(f.jsx)(g,{})}),p)}},[[15,1,2]]]);
//# sourceMappingURL=main.6524f729.chunk.js.map